<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>ëŒë¦¼íŒ ê²Œì„</title>
<style>
  body {
    text-align: center;
    font-family: Arial, sans-serif;
    background: #f3f3f3;
    padding-top: 50px;
  }
  canvas {
    border: 5px solid #444;
    border-radius: 50%;
    box-shadow: 0 0 20px #aaa;
    background: white;
  }
  #container {
    position: relative;
    width: 400px;
    margin: 0 auto;
  }
  #pointer {
    position: absolute;
    top: -18px; /* í™”ì‚´í‘œ ìœ„ì¹˜ ì¡°ê¸ˆ ë‚´ë¦¼ */
    left: 50%;
    margin-left: -15px;
    width: 0;
    height: 0;
    border-left: 15px solid transparent;
    border-right: 15px solid transparent;
    border-top: 30px solid red; /* ìœ„ìª½ í™”ì‚´í‘œ */
    z-index: 10;
  }
  #result {
    margin-top: 30px;
    font-size: 28px;
    font-weight: bold;
  }
  button {
    margin-top: 20px;
    font-size: 18px;
    padding: 10px 20px;
    cursor: pointer;
  }
</style>
</head>
<body>
  <h1>ğŸ¯ <strong>ëŒë¦¼íŒ ê²Œì„</strong></h1>
  <div id="container">
    <div id="pointer"></div>
    <canvas id="wheel" width="400" height="400"></canvas>
  </div>
  <button id="spinBtn">ëŒë¦¬ê¸°!</button>
  <div id="result"></div>

<script>
  const canvas = document.getElementById("wheel");
  const ctx = canvas.getContext("2d");
  const segments = [
    { color: "#f66", value: "1,000P" },
    { color: "#3af", value: "3,000P" },
    { color: "#fc3", value: "5,000P" },
    { color: "#399", value: "10,000P" },
    { color: "#96f", value: "ì¹˜í‚¨" },
  ];
  const segCount = segments.length;
  let startAngle = 0;

  function drawWheel() {
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
    const radius = Math.min(centerX, centerY) - 10;
    const segAngle = (2 * Math.PI) / segCount;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // ê° ì˜ì—­ ê·¸ë¦¬ê¸°
    for (let i = 0; i < segCount; i++) {
      const angle = startAngle + i * segAngle;

      // ì˜ì—­ ìƒ‰ìƒ ì±„ìš°ê¸°
      ctx.beginPath();
      ctx.moveTo(centerX, centerY);
      ctx.arc(centerX, centerY, radius, angle, angle + segAngle);
      ctx.closePath();

      ctx.fillStyle = segments[i].color;
      ctx.fill();
      ctx.strokeStyle = "#333";
      ctx.lineWidth = 2;
      ctx.stroke();

      // í…ìŠ¤íŠ¸ ì“°ê¸° (ì¤‘ì•™ ìœ„ì¹˜, ê°ë„ ì¡°ì •)
      ctx.save();
      ctx.fillStyle = "white";
      ctx.font = "bold 20px Arial";
      ctx.translate(centerX, centerY);
      ctx.rotate(angle + segAngle / 2);
      ctx.textAlign = "right";
      ctx.fillText(segments[i].value, radius - 10, 10);
      ctx.restore();
    }
  }

  // íšŒì „ ìƒíƒœ ë³€ìˆ˜
  let spinning = false;
  let angularVelocity = 0;
  let angularAcceleration = 0;
  let currentAngle = 0;

  function spin() {
    if (spinning) return;

    spinning = true;
    angularVelocity = Math.random() * 0.3 + 0.4; // ì´ˆê¸° ì†ë„ ëœë¤
    angularAcceleration = 0.005; // ê°ì† ê°’

    function animate() {
      if (!spinning) return;

      angularVelocity -= angularAcceleration;
      if (angularVelocity <= 0) {
        angularVelocity = 0;
        spinning = false;
        showResult();
        return;
      }

      currentAngle += angularVelocity;
      startAngle = currentAngle % (2 * Math.PI);
      drawWheel();
      requestAnimationFrame(animate);
    }

    animate();
  }

  function showResult() {
    // pointerëŠ” ìœ„ìª½ 12ì‹œ ë°©í–¥, ê°ë„ ê³„ì‚°
    const normalizedAngle = (2 * Math.PI - (startAngle % (2 * Math.PI))) % (2 * Math.PI);
    const segAngle = (2 * Math.PI) / segCount;
    let index = Math.floor(normalizedAngle / segAngle);
    index = index % segCount;

    const result = segments[index];
    document.getElementById("result").innerHTML = `ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ë‹¹ì²¨: <strong>${result.value}</strong>`;
  }

  // ì´ˆê¸° ëŒë¦¼íŒ ê·¸ë¦¬ê¸°
  drawWheel();

  document.getElementById("spinBtn").addEventListener("click", spin);
</script>
</body>
</html>
